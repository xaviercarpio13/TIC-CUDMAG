<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Detecci√≥n de Ambig√ºedad en Requisitos</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
      margin: 2rem;
      background-color: #f4f7f9;
    }

    h2,
    h3 {
      color: #2c3e50;
    }

    .container {
      background-color: white;
      padding: 2rem;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    textarea,
    select,
    input[type="text"] {
      width: 100%;
      padding: 0.75rem;
      margin: 0.5rem 0 1.5rem 0;
      border: 1px solid #dcdcdc;
      border-radius: 4px;
      box-sizing: border-box;
    }

    button {
      display: block;
      width: 100%;
      padding: 0.8rem 1rem;
      margin-top: 1rem;
      background-color: #007BFF;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1rem;
    }

    button:hover {
      background-color: #0056b3;
    }

    .resultado {
      margin-top: 2rem;
      padding: 1.5rem;
      border-left-width: 5px;
      border-left-style: solid;
      background-color: #f9f9f9;
    }

    .resultado.ambiguo {
      border-left-color: #e74c3c;
    }

    .resultado.no-ambiguo {
      border-left-color: #2ecc71;
    }

    .dynamic-text {
      background-color: #e6f7ff;
      padding: 3px 7px;
      border-radius: 4px;
      font-style: italic;
      font-weight: bold;
      color: #0056b3;
    }

    label,
    p {
      font-weight: 500;
      color: #34495e;
    }

    .formulario {
      display: none;
    }

    .formulario.activo {
      display: block;
    }

    .ejemplo {
      background-color: #f8f9fa;
      padding: 10px;
      border-left: 3px solid #28a745;
      margin: 10px 0;
      font-style: italic;
      color: #495057;
    }

    .dimension {
      margin: 20px 0;
      padding: 15px;
      border: 1px solid #e9ecef;
      border-radius: 5px;
    }

    .dimension h4 {
      color: #495057;
      margin-top: 0;
    }

    .checkbox-group {
      margin: 10px 0;
    }

    .checkbox-group input[type="radio"] {
      width: auto;
      margin-right: 8px;
    }

    .checkbox-group label {
      display: inline;
      font-weight: normal;
      margin-left: 5px;
    }
  </style>
</head>

<body>

  <div class="container">
    <h2>Formulario para Evaluaci√≥n de Ambig√ºedad en Requisitos</h2>

    <label for="requisito">1. Escriba el requerimiento completo:</label>
    <textarea id="requisito" rows="3"
      placeholder="Ej: Si no hay stock disponible, el sistema debe notificar al usuario."></textarea>

    <label for="tipoEvaluacion">2. Seleccione el tipo de evaluaci√≥n:</label>
    <select id="tipoEvaluacion" onchange="mostrarFormulario()">
      <option value="">Seleccione una opci√≥n</option>
      <option value="condicional">Ambig√ºedad Condicional</option>
      <option value="general">Ambig√ºedades Generales</option>
    </select>

    <!-- FORMULARIO PARA AMBIG√úEDAD CONDICIONAL -->
    <div id="formularioCondicional" class="formulario">
      <label for="antecedente">3. Escriba el antecedente (condici√≥n):</label>
      <input type="text" id="antecedente" oninput="actualizarTextoDinamico()" placeholder="Ej: No hay stock disponible">

      <label for="consecuente">4. Escriba el consecuente (acci√≥n):</label>
      <input type="text" id="consecuente" oninput="actualizarTextoDinamico()" placeholder="Ej: Notificar al usuario">

      <h3>Preguntas de Evaluaci√≥n</h3>

      <div class="dimension">
        <h4>1.1. Dimensi√≥n: Relaci√≥n l√≥gica (necesidad y/o suficiencia)</h4>
        <p>¬øCu√°l es la intenci√≥n l√≥gica entre la condici√≥n y la consecuencia?</p>
        <div class="checkbox-group">
          <input type="radio" id="logicaA" name="logica" value="A">
          <label for="logicaA" id="opcionA">A. Si la condici√≥n ocurre, la consecuencia debe ocurrir (Solo
            suficiente)</label>
        </div>
        <div class="checkbox-group">
          <input type="radio" id="logicaB" name="logica" value="B">
          <label for="logicaB" id="opcionB">B. La consecuencia ocurre √∫nicamente si ocurre la condici√≥n (Suficiente y
            necesaria)</label>
        </div>
        <div class="checkbox-group">
          <input type="radio" id="logicaC" name="logica" value="C">
          <label for="logicaC">C. La consecuencia puede ocurrir incluso si no se cumple la condici√≥n (No hay relaci√≥n
            l√≥gica estricta)</label>
        </div>
        <div class="checkbox-group">
          <input type="radio" id="logicaD" name="logica" value="D">
          <label for="logicaD">D. No estoy completamente seguro</label>
        </div>
      </div>

      <div class="dimension">
        <h4>1.2. Dimensi√≥n: Relaci√≥n temporal</h4>
        <p>¬øEn qu√© momento debe ocurrir la consecuencia respecto a la condici√≥n?</p>
        <div class="checkbox-group">
          <input type="radio" id="temporalidadA" name="temporalidad" value="A">
          <label for="temporalidadA">A. Mientras la condici√≥n se mantiene verdadera</label>
        </div>
        <div class="checkbox-group">
          <input type="radio" id="temporalidadB" name="temporalidad" value="B">
          <label for="temporalidadB">B. Inmediatamente despu√©s de que se cumpla la condici√≥n</label>
        </div>
        <div class="checkbox-group">
          <input type="radio" id="temporalidadC" name="temporalidad" value="C">
          <label for="temporalidadC">C. En alg√∫n momento futuro no determinado tras la condici√≥n</label>
        </div>
        <div class="checkbox-group">
          <input type="radio" id="temporalidadD" name="temporalidad" value="D">
          <label for="temporalidadD">D. El tiempo no es importante para este requisito</label>
        </div>
        <div class="checkbox-group">
          <input type="radio" id="temporalidadE" name="temporalidad" value="E">
          <label for="temporalidadE">E. No estoy completamente seguro</label>
        </div>
      </div>

      <div class="dimension">
        <h4>1.3. Consistencia l√≥gica</h4>
        <p>¬øQu√© espera que ocurra si...?</p>

        <p id="label-caso1">Si la condici√≥n <span class="dynamic-text dynamic-antecedente">...</span> ocurre, ¬øla acci√≥n
          <span class="dynamic-text dynamic-consecuente">...</span> debe ocurrir?
        </p>
        <select id="caso1">
          <option value="">Seleccione una opci√≥n</option>
          <option value="si">S√≠</option>
          <option value="no">No</option>
          <option value="ns">No estoy seguro</option>
        </select>

        <p id="label-caso2">Si la condici√≥n <span class="dynamic-text dynamic-antecedente">...</span> NO ocurre, ¬øla
          acci√≥n <span class="dynamic-text dynamic-consecuente">...</span> debe ocurrir?</p>
        <select id="caso2">
          <option value="">Seleccione una opci√≥n</option>
          <option value="si">S√≠</option>
          <option value="no">No</option>
          <option value="ns">No estoy seguro</option>
        </select>
      </div>

      <button onclick="evaluarAmbiguedadCondicional()">Evaluar Ambig√ºedad Condicional</button>
    </div>

    <!-- FORMULARIO PARA AMBIG√úEDADES GENERALES -->
    <div id="formularioGeneral" class="formulario">
      <h3>Evaluaci√≥n de Ambig√ºedades Generales</h3>

      <div class="dimension">
        <h4>2. Ambig√ºedad l√©xica</h4>
        <p>Palabras con m√∫ltiple significado</p>
        <p>¬øAlguna palabra o frase del requisito podr√≠a tener <strong>m√°s de un significado</strong> en el contexto del
          sistema?</p>
        <div class="ejemplo">
          Ejemplo: adecuado, apropiado,
          r√°pido, pronto, eficiente,
          √≥ptimo, perfecto, tolerante
          suficiente, aceptable, razonable, seguro, confiable, flexible, adaptable,
          econ√≥mico, barato, amigable, comprensible, usable, bueno/buena, bonito/bonita

        </div>
        <div class="checkbox-group">
          <input type="radio" id="lexicaSi" name="lexica" value="si">
          <label for="lexicaSi">S√≠</label>
        </div>
        <div class="checkbox-group">
          <input type="radio" id="lexicaNo" name="lexica" value="no">
          <label for="lexicaNo">No</label>
        </div>
        <div class="checkbox-group">
          <input type="radio" id="lexicaNs" name="lexica" value="ns">
          <label for="lexicaNs">No estoy seguro</label>
        </div>
      </div>

      <div class="dimension">
        <h4>3. Ambig√ºedad sint√°ctica</h4>
        <p>Estructura de oraci√≥n o p√°rrafo confusa</p>

        <p>¬øPuede la oraci√≥n entenderse de <strong>m√°s de una forma gramaticalmente v√°lida</strong>?</p>
        <div class="ejemplo">
          Ejemplo: "El sistema debe validar y enviar el formulario al servidor con autenticaci√≥n"
          ¬øQu√© tiene autenticaci√≥n: el servidor o el formulario?
        </div>
        <div class="checkbox-group">
          <input type="radio" id="sintacticaSi" name="sintactica" value="si">
          <label for="sintacticaSi">S√≠</label>
        </div>
        <div class="checkbox-group">
          <input type="radio" id="sintacticaNo" name="sintactica" value="no">
          <label for="sintacticaNo">No</label>
        </div>
        <div class="checkbox-group">
          <input type="radio" id="sintacticaNs" name="sintactica" value="ns">
          <label for="sintacticaNs">No estoy seguro</label>
        </div>
      </div>

      <div class="dimension">
        <h4>4. Ambig√ºedad referencial</h4>
        <p>Pronombres o sustantivos imprecisos</p>

        <p>¬øHay pronombres, adjetivos o referencias cuya identidad <strong>no queda clara</strong>?</p>
        <div class="ejemplo">
          Ejemplo: √©l, ella, su, sus, ti, este, esa, aquel, alguno, ninguno, cualquiera, cualquier, cada, cosa, objeto,
          situaci√≥n, elemento, recurso, dicho.

        </div>
        <div class="checkbox-group">
          <input type="radio" id="referencialSi" name="referencial" value="si">
          <label for="referencialSi">S√≠</label>
        </div>
        <div class="checkbox-group">
          <input type="radio" id="referencialNo" name="referencial" value="no">
          <label for="referencialNo">No</label>
        </div>
        <div class="checkbox-group">
          <input type="radio" id="referencialNs" name="referencial" value="ns">
          <label for="referencialNs">No estoy seguro</label>
        </div>
      </div>

      <div class="dimension">
        <h4>5. Ambig√ºedad por Cuantificadores vagos / lenguaje impreciso</h4>
        <p>Expresiones vagas sin definici√≥n concreta</p>
        <p>¬øSe utilizan <strong>cuantificadores generales</strong> o frases vagas sin definici√≥n concreta?</p>
        <div class="ejemplo">
          Ejemplo: poco, mucho, bastantes, algunas, varios, algunos, muchos, pocos, todos, cualquier, la mayor√≠a, una
          minor√≠a, a menudo, generalmente, ocasionalmente, casi siempre
        </div>
        <div class="checkbox-group">
          <input type="radio" id="cuantificadoresSi" name="cuantificadores" value="si">
          <label for="cuantificadoresSi">S√≠</label>
        </div>
        <div class="checkbox-group">
          <input type="radio" id="cuantificadoresNo" name="cuantificadores" value="no">
          <label for="cuantificadoresNo">No</label>
        </div>
        <div class="checkbox-group">
          <input type="radio" id="cuantificadoresNs" name="cuantificadores" value="ns">
          <label for="cuantificadoresNs">No estoy seguro</label>
        </div>
      </div>

      <div class="dimension">
        <h4>6. Ambig√ºedad por uso de voz pasiva</h4>
        <p>Omisi√≥n del agente sem√°ntico</p>
        <p>¬øHay oraciones en las que <strong>no se especifica qui√©n realiza la acci√≥n</strong>?</p>
        <div class="ejemplo">
          Ejemplo: "El archivo ser√° eliminado" ‚Üí ¬øpor qui√©n?
        </div>
        <div class="checkbox-group">
          <input type="radio" id="vozPasivaSi" name="vozPasiva" value="si">
          <label for="vozPasivaSi">S√≠</label>
        </div>
        <div class="checkbox-group">
          <input type="radio" id="vozPasivaNo" name="vozPasiva" value="no">
          <label for="vozPasivaNo">No</label>
        </div>
        <div class="checkbox-group">
          <input type="radio" id="vozPasivaNs" name="vozPasiva" value="ns">
          <label for="vozPasivaNs">No estoy seguro</label>
        </div>
      </div>

      <div class="dimension">
        <h4>7. Ambig√ºedad por contexto incompleto u omitido</h4>
        <p>Falta de condiciones, excepciones o valores necesarios</p>
        <p>¬øFaltan condiciones, excepciones o valores necesarios para comprender completamente el comportamiento
          esperado?</p>
        <div class="ejemplo">
          Ejemplo: "El sistema debe enviar una alerta cuando haya riesgo" ‚Üí ¬øQu√© es riesgo? ¬øC√≥mo se mide?
        </div>
        <div class="checkbox-group">
          <input type="radio" id="contextoSi" name="contexto" value="si">
          <label for="contextoSi">S√≠</label>
        </div>
        <div class="checkbox-group">
          <input type="radio" id="contextoNo" name="contexto" value="no">
          <label for="contextoNo">No</label>
        </div>
        <div class="checkbox-group">
          <input type="radio" id="contextoNs" name="contexto" value="ns">
          <label for="contextoNs">No estoy seguro</label>
        </div>
      </div>

      <button onclick="evaluarAmbiguedadesGenerales()">Evaluar Ambig√ºedades Generales</button>
    </div>

    <div id="resultado"></div>
  </div>

  <script>
    function mostrarFormulario() {
      const tipo = document.getElementById('tipoEvaluacion').value;
      const formularioCondicional = document.getElementById('formularioCondicional');
      const formularioGeneral = document.getElementById('formularioGeneral');

      // Ocultar todos los formularios
      formularioCondicional.classList.remove('activo');
      formularioGeneral.classList.remove('activo');

      // Mostrar el formulario seleccionado
      if (tipo === 'condicional') {
        formularioCondicional.classList.add('activo');
        actualizarTextoDinamico();
      } else if (tipo === 'general') {
        formularioGeneral.classList.add('activo');
      }

      // Limpiar resultado anterior
      document.getElementById('resultado').innerHTML = '';
    }

    function actualizarTextoDinamico() {
      const antecedente = document.getElementById('antecedente').value.trim() || '...';
      const consecuente = document.getElementById('consecuente').value.trim() || '...';

      // Actualiza todos los elementos que muestran el antecedente
      document.querySelectorAll('.dynamic-antecedente').forEach(el => {
        el.textContent = `"${antecedente}"`;
      });

      // Actualiza todos los elementos que muestran el consecuente
      document.querySelectorAll('.dynamic-consecuente').forEach(el => {
        el.textContent = `"${consecuente}"`;
      });

      // Actualiza din√°micamente las opciones del select
      document.getElementById('opcionA').textContent = `A. Si la condici√≥n "${antecedente}" se cumple, ocurre la acci√≥n "${consecuente}" (suficiente)`;
      document.getElementById('opcionB').textContent = `B. La acci√≥n "${consecuente}" ocurre solo si se cumple la condici√≥n "${antecedente}" (necesaria)`;
    }

    function evaluarAmbiguedadCondicional() {
      const requisito = document.getElementById('requisito').value.trim();
      const antecedente = document.getElementById('antecedente').value.trim();
      const consecuente = document.getElementById('consecuente').value.trim();
      const logica = document.querySelector('input[name="logica"]:checked')?.value;
      const temporalidad = document.querySelector('input[name="temporalidad"]:checked')?.value;
      const caso1 = document.getElementById('caso1').value;
      const caso2 = document.getElementById('caso2').value;

      let ambiguo = false;
      let razones = [];

      // Validar campos obligatorios
      if (!requisito || !antecedente || !consecuente) {
        alert("Por favor, complete todos los campos obligatorios.");
        return;
      }

      // Ambig√ºedad de interpretaci√≥n l√≥gica
      if (logica === "D") {
        ambiguo = true;
        razones.push("Ambig√ºedad de interpretaci√≥n l√≥gica: No est√° claro si la condici√≥n es suficiente, necesaria o ambas.");
      }

      if (caso1 === "ns" || caso2 === "ns") {
        ambiguo = true;
        razones.push("Ambig√ºedad de interpretaci√≥n l√≥gica: Incertidumbre en el comportamiento esperado en escenarios clave.");
      }

      // Ambig√ºedad sem√°ntica del condicional
      if (caso1 === "si" && caso2 === "si") {
        ambiguo = true;
        razones.push(`Ambig√ºedad sem√°ntica: la consecuencia <span class="dynamic-text">"${consecuente}"</span> se espera tanto si ocurre como si no ocurre la condici√≥n <span class="dynamic-text">"${antecedente}"</span>.`);
      }

      // Contradicci√≥n entre l√≥gica y consistencia
      if (logica === "A" && caso1 === "si" && caso2 === "no") {
        // Esto es consistente, no es ambiguo
      } else if (logica === "A" && caso2 === "si") {
        ambiguo = true;
        razones.push("Contradicci√≥n l√≥gica: has marcado la condici√≥n como suficiente, pero esperas que la consecuencia ocurra incluso sin la condici√≥n.");
      }

      // Ambig√ºedad temporal
      if (temporalidad === "E") {
        ambiguo = true;
        razones.push("Ambig√ºedad temporal: No est√° claro cu√°ndo debe ocurrir la consecuencia en relaci√≥n con la condici√≥n.");
      }

      // Verificar si el requisito menciona expl√≠citamente el tiempo
      const tiempoExplicito = /\b(inmediatamente|despu√©s|mientras|cuando|durante|antes|luego|posteriormente|al instante|en el momento)\b/i.test(requisito);
      if (!tiempoExplicito && temporalidad && temporalidad !== "D" && temporalidad !== "E") {
        ambiguo = true;
        razones.push("Temporalidad impl√≠cita no expresada: El requisito no menciona expl√≠citamente cu√°ndo debe ocurrir la consecuencia.");
      }

      mostrarResultado(requisito, ambiguo, razones, 'condicional', { antecedente, consecuente });
    }

    function evaluarAmbiguedadesGenerales() {
      const requisito = document.getElementById('requisito').value.trim();

      if (!requisito) {
        alert("Por favor, escriba el requerimiento completo.");
        return;
      }

      let ambiguedadesDetectadas = [];

      // Verificar cada tipo de ambig√ºedad
      const ambiguedades = [
        { name: 'lexica', label: 'Ambig√ºedad l√©xica' },
        { name: 'sintactica', label: 'Ambig√ºedad sint√°ctica' },
        { name: 'referencial', label: 'Ambig√ºedad referencial' },
        { name: 'cuantificadores', label: 'Ambig√ºedad por cuantificadores vagos' },
        { name: 'vozPasiva', label: 'Ambig√ºedad por uso de voz pasiva' },
        { name: 'contexto', label: 'Ambig√ºedad por contexto incompleto' }
      ];

      ambiguedades.forEach(amb => {
        const valor = document.querySelector(`input[name="${amb.name}"]:checked`)?.value;
        if (valor === 'si' || valor === 'ns') {
          ambiguedadesDetectadas.push({
            tipo: amb.label,
            certeza: valor === 'si' ? 'Detectada' : 'Posible (no est√° seguro)'
          });
        }
      });

      const ambiguo = ambiguedadesDetectadas.length > 0;
      mostrarResultado(requisito, ambiguo, ambiguedadesDetectadas, 'general');
    }

    function mostrarResultado(requisito, ambiguo, datos, tipo, extra = {}) {
      const resultadoDiv = document.getElementById('resultado');
      let resultadoHTML = `<h4>Resultado de la Evaluaci√≥n:</h4>`;
      resultadoHTML += `<p><strong>Requisito evaluado:</strong> ${requisito}</p>`;

      if (tipo === 'condicional') {
        resultadoHTML += `<p><strong>Condici√≥n (Antecedente):</strong> ${extra.antecedente}<br>`;
        resultadoHTML += `<strong>Acci√≥n (Consecuente):</strong> ${extra.consecuente}</p>`;
      }

      if (ambiguo) {
        resultadoHTML += `<strong>üî¥ Requisito Ambiguo</strong><br>`;

        if (tipo === 'condicional') {
          resultadoHTML += `<p>Se han detectado las siguientes ambig√ºedades condicionales:</p><ul>` + datos.map(r => `<li>${r}</li>`).join('') + `</ul>`;
        } else {
          resultadoHTML += `<p>Se han detectado los siguientes requirement smells:</p><ul>` + datos.map(d => `<li><strong>${d.tipo}:</strong> ${d.certeza}</li>`).join('') + `</ul>`;
        }

        resultadoDiv.className = 'resultado ambiguo';
      } else {
        resultadoHTML += `<strong>üü¢ Requisito No Ambiguo</strong><br>`;

        if (tipo === 'condicional') {
          resultadoHTML += `<p>Seg√∫n sus respuestas, no se detectaron ambig√ºedades condicionales. El comportamiento esperado es claro.</p>`;
        } else {
          resultadoHTML += `<p>No se detectaron requirement smells relacionados con ambig√ºedades generales.</p>`;
        }

        resultadoDiv.className = 'resultado no-ambiguo';
      }

      resultadoDiv.innerHTML = resultadoHTML;
    }

    // Inicializar
    window.onload = function () {
      mostrarFormulario();
    };
  </script>

</body>

</html>